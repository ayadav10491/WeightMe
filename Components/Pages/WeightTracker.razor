@page "/weight-tracker"
@using WeightMe.Model
@using WeightMe.Data
@inject IJSRuntime JSRuntime

@inject DatabaseService DbService;

<h3>Weight Tracker</h3>

<ul>
    @foreach (var entry in weightEntries)
    {
        <li>@entry.EntryDate.ToShortDateString(): @entry.Weight kg</li>
    }
</ul>

<h3>Weight Chart</h3>

<canvas id="weightChart" width="400" height="200"></canvas>

<input @bind="newWeight" type="number" placeholder="New weight (kg)" />
<input @bind="newDate" type="date" />
<button @onclick="AddWeightEntry">Add Entry</button>

@code {
    private List<WeightEntry> weightEntries = new();
    private double newWeight;
    private DateTime newDate = DateTime.Now;

    protected override async Task OnInitializedAsync()
    {
        weightEntries = await DbService.GetWeightEntriesAsync();
    }

    private async Task AddWeightEntry()
    {
        if (newWeight > 0)
        {
            var newEntry = new WeightEntry { EntryDate = newDate, Weight = newWeight };
            await DbService.SaveWeightEntryAsync(newEntry);
            weightEntries = await DbService.GetWeightEntriesAsync();
            newWeight = 0;
            newDate = DateTime.Now;
        }
    }
}






